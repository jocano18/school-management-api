-- PostgreSQL database dump
-- Coherente con import.sql v2026

SET statement_timeout = 0;
SET lock_timeout = 0;
SET client_encoding = 'UTF8';
SET standard_conforming_strings = on;
SET check_function_bodies = false;
SET row_security = off;

-- 1. LIMPIEZA TOTAL
DROP TABLE IF EXISTS public.notas CASCADE;
DROP TABLE IF EXISTS public.materias CASCADE;
DROP TABLE IF EXISTS public.alumnos CASCADE;

-- 2. CREACIÓN DE TABLAS
CREATE TABLE public.alumnos (
    id bigint NOT NULL GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
    nombre character varying(50) NOT NULL,
    apellido character varying(50) NOT NULL,
    email character varying(100) NOT NULL UNIQUE,
    fecha_nacimiento date NOT NULL
);

CREATE TABLE public.materias (
    id bigint NOT NULL GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
    nombre character varying(100) NOT NULL UNIQUE,
    codigo character varying(100) NOT NULL UNIQUE,
    creditos integer NOT NULL
);

CREATE TABLE public.notas (
    id bigint NOT NULL GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
    valor double precision NOT NULL,
    fecha_registro timestamp without time zone NOT NULL,
    alumno_id bigint REFERENCES public.alumnos(id),
    materia_id bigint REFERENCES public.materias(id)
);

-- 3. CARGA DE DATOS: ALUMNOS
COPY public.alumnos (id, nombre, apellido, email, fecha_nacimiento) FROM stdin;
1	Juan	Pérez	juan.perez@escuela.com	2005-03-15
2	María	González	maria.gonzalez@escuela.com	2004-07-22
3	Carlos	Rodríguez	carlos.rodriguez@escuela.com	2005-11-08
4	Ana	Martínez	ana.martinez@escuela.com	2004-01-30
5	Luis	López	luis.lopez@escuela.com	2005-05-12
6	Laura	Hernández	laura.hernandez@escuela.com	2004-09-25
7	Pedro	García	pedro.garcia@escuela.com	2005-02-18
8	Sofía	Díaz	sofia.diaz@escuela.com	2004-12-05
9	Diego	Sánchez	diego.sanchez@escuela.com	2005-08-14
10	Valentina	Torres	valentina.torres@escuela.com	2004-06-20
\.

-- 4. CARGA DE DATOS: MATERIAS
COPY public.materias (id, nombre, codigo, creditos) FROM stdin;
1	Matemáticas	MAT101	4
2	Física	FIS101	4
3	Química	QUI101	3
4	Historia	HIS101	3
5	Programación	PRG101	5
6	Literatura	LIT101	2
7	Biología	BIO101	3
8	Inglés	ENG101	2
9	Geografía	GEO101	3
10	Filosofía	PHI101	2
\.

-- 5. CARGA DE DATOS
COPY public.notas (id, valor, fecha_registro, alumno_id, materia_id) FROM stdin;
1	4.5	2026-01-15 08:00:00	1	1
2	4.2	2026-01-15 09:00:00	2	2
3	3.8	2026-01-15 10:00:00	3	5
4	4.8	2026-01-15 11:00:00	4	3
5	4.0	2026-01-15 12:00:00	5	5
6	4.3	2026-01-15 13:00:00	6	1
7	3.9	2026-01-15 14:00:00	7	2
8	4.7	2026-01-15 15:00:00	8	8
9	5.0	2026-01-15 16:00:00	9	9
10	4.6	2026-01-15 17:00:00	10	10
\.

-- 6. SINCRONIZACIÓN DE SECUENCIAS
SELECT pg_catalog.setval('public.alumnos_id_seq', 10, true);
SELECT pg_catalog.setval('public.materias_id_seq', 10, true);
SELECT pg_catalog.setval('public.notas_id_seq', 10, true);